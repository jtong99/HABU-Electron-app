<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HABU AI GEN PREMIUM - Đăng nhập</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .container {
            background: white;
            border-radius: 20px;
            padding: 32px;
            max-width: 480px;
            width: 100%;
            box-shadow: 0 25px 80px rgba(0,0,0,0.4);
        }
        .logo-section {
            text-align: center;
            margin-bottom: 20px;
        }
        .logo {
            width: 64px;
            height: 64px;
            border-radius: 14px;
            object-fit: cover;
            margin-bottom: 8px;
        }
        h1 {
            color: #1a1a2e;
            font-size: 20px;
            margin-bottom: 2px;
        }
        .subtitle {
            color: #888;
            font-size: 12px;
        }

        /* Steps */
        .steps-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }
        .steps-title {
            color: #333;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 12px;
        }
        .step {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: flex-start;
        }
        .step:last-child {
            margin-bottom: 0;
        }
        .step-number {
            width: 22px;
            height: 22px;
            background: linear-gradient(135deg, #4285f4, #1967d2);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
            flex-shrink: 0;
        }
        .step-content {
            flex: 1;
            font-size: 13px;
            color: #444;
            line-height: 1.4;
        }
        .step-link {
            color: #1967d2;
            text-decoration: none;
            font-weight: 500;
        }
        .step-link:hover {
            text-decoration: underline;
        }
        .highlight {
            background: #fff59d;
            padding: 0 3px;
            border-radius: 2px;
            font-weight: 500;
        }

        /* Final Step */
        .final-step {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border: 1px solid #a5d6a7;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
        }
        .final-step-title {
            color: #2e7d32;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        .paste-btn {
            width: 100%;
            padding: 14px 20px;
            font-size: 15px;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, #43a047, #2e7d32);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(46, 125, 50, 0.3);
        }
        .paste-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(46, 125, 50, 0.4);
        }
        .paste-btn:active {
            transform: translateY(0);
        }
        .paste-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }
        .final-hint {
            color: #558b2f;
            font-size: 11px;
            margin-top: 8px;
        }

        /* Messages */
        .message {
            padding: 14px 16px;
            border-radius: 10px;
            margin-bottom: 16px;
            display: none;
            font-size: 13px;
            text-align: center;
            animation: slideDown 0.3s ease-out;
        }
        .message.show {
            display: block;
        }
        .message-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        .message-title {
            font-weight: 600;
            margin-bottom: 4px;
        }
        .message-text {
            line-height: 1.5;
        }

        /* Error Message */
        .error-msg {
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            border: 1px solid #ef9a9a;
            color: #c62828;
        }
        .error-msg.shake {
            animation: shake 0.5s ease-in-out;
        }

        /* Success Message */
        .success-msg {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border: 1px solid #a5d6a7;
            color: #2e7d32;
        }
        .success-msg .message-icon {
            animation: bounceIn 0.5s ease-out;
        }

        /* Loading */
        .loading {
            display: none;
            text-align: center;
            padding: 20px 16px;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 1px solid #90caf9;
            border-radius: 12px;
            margin-bottom: 16px;
            animation: slideDown 0.3s ease-out;
        }
        .loading.show {
            display: block;
        }
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #e0e0e0;
            border-top-color: #1976d2;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 12px;
        }
        .loading-text {
            color: #1565c0;
            font-size: 14px;
            font-weight: 500;
        }
        .loading-hint {
            color: #1976d2;
            font-size: 11px;
            margin-top: 4px;
        }

        /* Animations */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-8px); }
            40% { transform: translateX(8px); }
            60% { transform: translateX(-8px); }
            80% { transform: translateX(8px); }
        }
        @keyframes bounceIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Footer */
        .footer {
            text-align: center;
            margin-top: 16px;
        }
        .footer-text {
            color: #999;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo-section">
            <img src="logo.jpeg" alt="HABU AI" class="logo">
            <h1>HABU AI GEN PREMIUM</h1>
            <p class="subtitle">Ứng dụng tạo ảnh AI chuyên nghiệp</p>
        </div>

        <div class="steps-section">
            <div class="steps-title">Hướng dẫn kết nối (chỉ cần làm 1 lần):</div>

            <div class="step">
                <div class="step-number">1</div>
                <div class="step-content">
                    Cài extension <a href="https://chromewebstore.google.com/detail/editthiscookie-v3/ojfebgpkimhlhcblbalbfjblapadhbol" target="_blank" class="step-link">EditThisCookie</a> trên Chrome
                </div>
            </div>

            <div class="step">
                <div class="step-number">2</div>
                <div class="step-content">
                    Mở <a href="https://aistudio.google.com" target="_blank" class="step-link">aistudio.google.com</a> và đăng nhập tài khoản Google
                </div>
            </div>

            <div class="step">
                <div class="step-number">3</div>
                <div class="step-content">
                    Nhấn icon <span class="highlight">EditThisCookie</span> trên thanh công cụ (góc phải trên)
                </div>
            </div>

            <div class="step">
                <div class="step-number">4</div>
                <div class="step-content">
                    Nhấn nút <span class="highlight">Export</span> (mũi tên lên) để sao chép cookies
                </div>
            </div>
        </div>

        <!-- Error Message -->
        <div id="error" class="message error-msg">
            <div class="message-icon">⚠️</div>
            <div class="message-title" id="error-title">Chưa thể kết nối</div>
            <div class="message-text" id="error-text"></div>
        </div>

        <!-- Success Message -->
        <div id="success" class="message success-msg">
            <div class="message-icon">✅</div>
            <div class="message-title">Kết nối thành công!</div>
            <div class="message-text">Đang chuyển đến ứng dụng...</div>
        </div>

        <!-- Loading -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <div class="loading-text">Đang kết nối...</div>
            <div class="loading-hint">Vui lòng chờ trong giây lát</div>
        </div>

        <div id="final-step" class="final-step">
            <div class="final-step-title">Bước cuối: Nhấn nút bên dưới</div>
            <button id="paste-btn" class="paste-btn" onclick="pasteCookies()">
                Dán Cookies và Truy cập
            </button>
            <div class="final-hint">Ứng dụng sẽ tự động đọc dữ liệu từ bộ nhớ</div>
        </div>

        <div class="footer">
            <p class="footer-text">Dữ liệu được lưu lại, bạn chỉ cần thực hiện 1 lần</p>
        </div>
    </div>

    <script>
        let isProcessing = false;

        async function pasteCookies() {
            if (isProcessing) return;
            isProcessing = true;

            const errorEl = document.getElementById('error');
            const successEl = document.getElementById('success');
            const loadingEl = document.getElementById('loading');
            const finalStepEl = document.getElementById('final-step');
            const pasteBtn = document.getElementById('paste-btn');

            // Hide all messages
            errorEl.classList.remove('show', 'shake');
            successEl.classList.remove('show');

            // Show loading
            loadingEl.classList.add('show');
            finalStepEl.style.display = 'none';
            pasteBtn.disabled = true;

            if (window.habuAPI && window.habuAPI.pasteCookiesFromClipboard) {
                const result = await window.habuAPI.pasteCookiesFromClipboard();

                loadingEl.classList.remove('show');

                if (result.success) {
                    // Show success message
                    successEl.classList.add('show');
                } else {
                    // Show error message with animation
                    finalStepEl.style.display = 'block';
                    pasteBtn.disabled = false;

                    const { title, text } = getErrorMessage(result.error);
                    document.getElementById('error-title').textContent = title;
                    document.getElementById('error-text').textContent = text;

                    errorEl.classList.add('show');
                    // Trigger shake animation
                    setTimeout(() => {
                        errorEl.classList.add('shake');
                    }, 10);

                    isProcessing = false;
                }
            } else {
                loadingEl.classList.remove('show');
                finalStepEl.style.display = 'block';
                pasteBtn.disabled = false;
                isProcessing = false;
            }
        }

        function getErrorMessage(error) {
            switch(error) {
                case 'Clipboard empty':
                    return {
                        title: 'Chưa có dữ liệu trong bộ nhớ!',
                        text: 'Bạn cần thực hiện Bước 3 và Bước 4 trước. Nhấn vào icon EditThisCookie rồi nhấn nút Export.'
                    };
                case 'Invalid JSON':
                    return {
                        title: 'Dữ liệu không đúng định dạng!',
                        text: 'Dữ liệu bạn sao chép không phải là cookies. Vui lòng nhấn đúng nút Export (mũi tên lên) trong EditThisCookie.'
                    };
                case 'Not an array':
                    return {
                        title: 'Định dạng cookies không hợp lệ!',
                        text: 'Vui lòng thử lại từ Bước 2: Mở trang aistudio.google.com, sau đó thực hiện lại các bước.'
                    };
                case 'Empty array':
                    return {
                        title: 'Không có cookies nào!',
                        text: 'Danh sách cookies trống. Vui lòng đảm bảo bạn đã đăng nhập tài khoản Google trên trang aistudio.google.com.'
                    };
                case 'Invalid cookie format':
                    return {
                        title: 'Cookies không đúng định dạng!',
                        text: 'Mỗi cookie cần có domain, name và value. Vui lòng sử dụng extension EditThisCookie và nhấn nút Export để sao chép đúng cách.'
                    };
                case 'Wrong domain':
                    return {
                        title: 'Cookies không phải từ Google!',
                        text: 'Bạn cần sao chép cookies từ trang aistudio.google.com. Vui lòng mở trang đó, đăng nhập, rồi thực hiện lại Bước 3 và 4.'
                    };
                default:
                    return {
                        title: 'Có lỗi xảy ra!',
                        text: 'Vui lòng thử lại. Nếu vẫn gặp lỗi, hãy khởi động lại ứng dụng.'
                    };
            }
        }
    </script>
</body>
</html>
