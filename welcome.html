<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HABU AI GEN PREMIUM - ƒêƒÉng nh·∫≠p</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .container {
            background: white;
            border-radius: 20px;
            padding: 32px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 25px 80px rgba(0,0,0,0.4);
        }
        .logo-section {
            text-align: center;
            margin-bottom: 24px;
        }
        .logo {
            width: 64px;
            height: 64px;
            border-radius: 14px;
            object-fit: cover;
            margin-bottom: 8px;
        }
        h1 {
            color: #1a1a2e;
            font-size: 20px;
            margin-bottom: 2px;
        }
        .subtitle {
            color: #888;
            font-size: 12px;
        }

        /* Options Section */
        .options-section {
            margin-bottom: 20px;
        }
        .option-title {
            color: #333;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            text-align: center;
        }
        .options {
            display: flex;
            gap: 12px;
        }
        .option-btn {
            flex: 1;
            padding: 16px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        .option-btn:hover {
            border-color: #4285f4;
            background: #f8f9ff;
        }
        .option-btn.active {
            border-color: #4285f4;
            background: #e8f0fe;
        }
        .option-icon {
            font-size: 28px;
            margin-bottom: 8px;
        }
        .option-label {
            font-size: 13px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }
        .option-desc {
            font-size: 11px;
            color: #888;
        }

        /* Direct Use Section */
        .direct-section {
            display: none;
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-radius: 12px;
            margin-bottom: 16px;
        }
        .direct-section.show {
            display: block;
        }
        .direct-btn {
            width: 100%;
            padding: 14px 20px;
            font-size: 15px;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, #4285f4, #1967d2);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(66, 133, 244, 0.3);
        }
        .direct-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(66, 133, 244, 0.4);
        }
        .direct-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }
        .direct-hint {
            color: #1565c0;
            font-size: 11px;
            margin-top: 10px;
        }

        /* Paste Section */
        .paste-section {
            display: none;
        }
        .paste-section.show {
            display: block;
        }

        /* Steps */
        .steps-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
        }
        .steps-title {
            color: #333;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 12px;
        }
        .step {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: flex-start;
        }
        .step:last-child {
            margin-bottom: 0;
        }
        .step-number {
            width: 22px;
            height: 22px;
            background: linear-gradient(135deg, #4285f4, #1967d2);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
            flex-shrink: 0;
        }
        .step-content {
            flex: 1;
            font-size: 13px;
            color: #444;
            line-height: 1.4;
        }
        .step-link {
            color: #1967d2;
            text-decoration: none;
            font-weight: 500;
        }
        .step-link:hover {
            text-decoration: underline;
        }
        .highlight {
            background: #fff59d;
            padding: 0 3px;
            border-radius: 2px;
            font-weight: 500;
        }

        /* Final Step */
        .final-step {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border: 1px solid #a5d6a7;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
        }
        .final-step-title {
            color: #2e7d32;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        .paste-btn {
            width: 100%;
            padding: 14px 20px;
            font-size: 15px;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, #43a047, #2e7d32);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(46, 125, 50, 0.3);
        }
        .paste-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(46, 125, 50, 0.4);
        }
        .paste-btn:active {
            transform: translateY(0);
        }
        .paste-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }
        .final-hint {
            color: #558b2f;
            font-size: 11px;
            margin-top: 8px;
        }

        /* Messages */
        .message {
            padding: 14px 16px;
            border-radius: 10px;
            margin-bottom: 16px;
            display: none;
            font-size: 13px;
            text-align: center;
            animation: slideDown 0.3s ease-out;
        }
        .message.show {
            display: block;
        }
        .message-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        .message-title {
            font-weight: 600;
            margin-bottom: 4px;
        }
        .message-text {
            line-height: 1.5;
        }

        /* Error Message */
        .error-msg {
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
            border: 1px solid #ef9a9a;
            color: #c62828;
        }
        .error-msg.shake {
            animation: shake 0.5s ease-in-out;
        }

        /* Success Message */
        .success-msg {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border: 1px solid #a5d6a7;
            color: #2e7d32;
        }
        .success-msg .message-icon {
            animation: bounceIn 0.5s ease-out;
        }

        /* Loading */
        .loading {
            display: none;
            text-align: center;
            padding: 20px 16px;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 1px solid #90caf9;
            border-radius: 12px;
            margin-bottom: 16px;
            animation: slideDown 0.3s ease-out;
        }
        .loading.show {
            display: block;
        }
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #e0e0e0;
            border-top-color: #1976d2;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 12px;
        }
        .loading-text {
            color: #1565c0;
            font-size: 14px;
            font-weight: 500;
        }
        .loading-hint {
            color: #1976d2;
            font-size: 11px;
            margin-top: 4px;
        }

        /* Animations */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-8px); }
            40% { transform: translateX(8px); }
            60% { transform: translateX(-8px); }
            80% { transform: translateX(8px); }
        }
        @keyframes bounceIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* Footer */
        .footer {
            text-align: center;
            margin-top: 16px;
        }
        .footer-text {
            color: #999;
            font-size: 11px;
        }

        /* Admin Button */
        .admin-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 16px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: rgba(255,255,255,0.6);
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .admin-btn:hover {
            background: rgba(255,255,255,0.2);
            color: rgba(255,255,255,0.9);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo-section">
            <img src="logo.jpeg" alt="HABU AI" class="logo">
            <h1>HABU AI GEN PREMIUM</h1>
            <p class="subtitle">·ª®ng d·ª•ng t·∫°o ·∫£nh AI chuy√™n nghi·ªáp</p>
        </div>

        <!-- Options -->
        <div class="options-section">
            <div class="option-title">Ch·ªçn c√°ch truy c·∫≠p:</div>
            <div class="options">
                <button class="option-btn active" onclick="selectOption('direct')" id="opt-direct">
                    <div class="option-icon">üöÄ</div>
                    <div class="option-label">Truy c·∫≠p nhanh</div>
                    <div class="option-desc">T·ª± ƒë·ªông k·∫øt n·ªëi</div>
                </button>
                <button class="option-btn" onclick="selectOption('paste')" id="opt-paste">
                    <div class="option-icon">üìã</div>
                    <div class="option-label">D√πng Cookies</div>
                    <div class="option-desc">T·ª± paste cookies</div>
                </button>
            </div>
        </div>

        <!-- Error Message -->
        <div id="error" class="message error-msg">
            <div class="message-icon">‚ö†Ô∏è</div>
            <div class="message-title" id="error-title">Ch∆∞a th·ªÉ k·∫øt n·ªëi</div>
            <div class="message-text" id="error-text"></div>
        </div>

        <!-- Success Message -->
        <div id="success" class="message success-msg">
            <div class="message-icon">‚úÖ</div>
            <div class="message-title">K·∫øt n·ªëi th√†nh c√¥ng!</div>
            <div class="message-text">ƒêang chuy·ªÉn ƒë·∫øn ·ª©ng d·ª•ng...</div>
        </div>

        <!-- Loading -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <div class="loading-text">ƒêang k·∫øt n·ªëi...</div>
            <div class="loading-hint">Vui l√≤ng ch·ªù trong gi√¢y l√°t</div>
        </div>

        <!-- Direct Use Section -->
        <div id="direct-section" class="direct-section show">
            <button id="direct-btn" class="direct-btn" onclick="useDirectAccess()">
                Truy c·∫≠p ngay
            </button>
            <div class="direct-hint">S·ª≠ d·ª•ng cookies c√≥ s·∫µn trong h·ªá th·ªëng</div>
        </div>

        <!-- Paste Cookies Section -->
        <div id="paste-section" class="paste-section">
            <div class="steps-section">
                <div class="steps-title">H∆∞·ªõng d·∫´n k·∫øt n·ªëi (ch·ªâ c·∫ßn l√†m 1 l·∫ßn):</div>

                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        C√†i extension <a href="https://chromewebstore.google.com/detail/editthiscookie-v3/ojfebgpkimhlhcblbalbfjblapadhbol" target="_blank" class="step-link">EditThisCookie</a> tr√™n Chrome
                    </div>
                </div>

                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        M·ªü <a href="https://aistudio.google.com" target="_blank" class="step-link">aistudio.google.com</a> v√† ƒëƒÉng nh·∫≠p t√†i kho·∫£n Google
                    </div>
                </div>

                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        Nh·∫•n icon <span class="highlight">EditThisCookie</span> tr√™n thanh c√¥ng c·ª• (g√≥c ph·∫£i tr√™n)
                    </div>
                </div>

                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        Nh·∫•n n√∫t <span class="highlight">Export</span> (m≈©i t√™n l√™n) ƒë·ªÉ sao ch√©p cookies
                    </div>
                </div>
            </div>

            <div id="final-step" class="final-step">
                <div class="final-step-title">B∆∞·ªõc cu·ªëi: Nh·∫•n n√∫t b√™n d∆∞·ªõi</div>
                <button id="paste-btn" class="paste-btn" onclick="pasteCookies()">
                    D√°n Cookies v√† Truy c·∫≠p
                </button>
                <div class="final-hint">·ª®ng d·ª•ng s·∫Ω t·ª± ƒë·ªông ƒë·ªçc d·ªØ li·ªáu t·ª´ b·ªô nh·ªõ</div>
            </div>
        </div>

        <div class="footer">
            <p class="footer-text">D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u l·∫°i, b·∫°n ch·ªâ c·∫ßn th·ª±c hi·ªán 1 l·∫ßn</p>
        </div>
    </div>

    <!-- Admin Button -->
    <button class="admin-btn" onclick="goToAdmin()">Admin</button>

    <script>
        let isProcessing = false;
        let currentOption = 'direct';

        // Select option
        function selectOption(option) {
            currentOption = option;

            // Update buttons
            document.getElementById('opt-direct').classList.toggle('active', option === 'direct');
            document.getElementById('opt-paste').classList.toggle('active', option === 'paste');

            // Show/hide sections
            document.getElementById('direct-section').classList.toggle('show', option === 'direct');
            document.getElementById('paste-section').classList.toggle('show', option === 'paste');

            // Hide messages
            document.getElementById('error').classList.remove('show');
            document.getElementById('success').classList.remove('show');
        }

        // Go to admin page
        async function goToAdmin() {
            if (window.habuAPI && window.habuAPI.goToAdminPage) {
                await window.habuAPI.goToAdminPage();
            }
        }

        // Direct access using Supabase cookies
        async function useDirectAccess() {
            if (isProcessing) return;
            isProcessing = true;

            const errorEl = document.getElementById('error');
            const successEl = document.getElementById('success');
            const loadingEl = document.getElementById('loading');
            const directSection = document.getElementById('direct-section');
            const directBtn = document.getElementById('direct-btn');

            // Hide messages
            errorEl.classList.remove('show', 'shake');
            successEl.classList.remove('show');

            // Show loading
            loadingEl.classList.add('show');
            directSection.classList.remove('show');
            directBtn.disabled = true;

            if (window.habuAPI && window.habuAPI.useSupabaseCookies) {
                const result = await window.habuAPI.useSupabaseCookies();

                loadingEl.classList.remove('show');

                if (result.success) {
                    successEl.classList.add('show');
                } else {
                    directSection.classList.add('show');
                    directBtn.disabled = false;

                    const { title, text } = getDirectErrorMessage(result.error);
                    document.getElementById('error-title').textContent = title;
                    document.getElementById('error-text').textContent = text;

                    errorEl.classList.add('show');
                    setTimeout(() => errorEl.classList.add('shake'), 10);

                    isProcessing = false;
                }
            } else {
                loadingEl.classList.remove('show');
                directSection.classList.add('show');
                directBtn.disabled = false;
                isProcessing = false;
            }
        }

        // Paste cookies
        async function pasteCookies() {
            if (isProcessing) return;
            isProcessing = true;

            const errorEl = document.getElementById('error');
            const successEl = document.getElementById('success');
            const loadingEl = document.getElementById('loading');
            const finalStepEl = document.getElementById('final-step');
            const pasteBtn = document.getElementById('paste-btn');

            // Hide all messages
            errorEl.classList.remove('show', 'shake');
            successEl.classList.remove('show');

            // Show loading
            loadingEl.classList.add('show');
            finalStepEl.style.display = 'none';
            pasteBtn.disabled = true;

            if (window.habuAPI && window.habuAPI.pasteCookiesFromClipboard) {
                const result = await window.habuAPI.pasteCookiesFromClipboard();

                loadingEl.classList.remove('show');

                if (result.success) {
                    // Show success message
                    successEl.classList.add('show');
                } else {
                    // Show error message with animation
                    finalStepEl.style.display = 'block';
                    pasteBtn.disabled = false;

                    const { title, text } = getPasteErrorMessage(result.error);
                    document.getElementById('error-title').textContent = title;
                    document.getElementById('error-text').textContent = text;

                    errorEl.classList.add('show');
                    // Trigger shake animation
                    setTimeout(() => {
                        errorEl.classList.add('shake');
                    }, 10);

                    isProcessing = false;
                }
            } else {
                loadingEl.classList.remove('show');
                finalStepEl.style.display = 'block';
                pasteBtn.disabled = false;
                isProcessing = false;
            }
        }

        function getDirectErrorMessage(error) {
            switch(error) {
                case 'No cookies in database':
                    return {
                        title: 'Ch∆∞a c√≥ cookies trong h·ªá th·ªëng!',
                        text: 'Vui l√≤ng li√™n h·ªá admin ho·∫∑c s·ª≠ d·ª•ng c√°ch "D√πng Cookies" ƒë·ªÉ t·ª± k·∫øt n·ªëi.'
                    };
                case 'Invalid cookies data':
                    return {
                        title: 'D·ªØ li·ªáu cookies kh√¥ng h·ª£p l·ªá!',
                        text: 'Vui l√≤ng li√™n h·ªá admin ƒë·ªÉ ki·ªÉm tra cookies trong h·ªá th·ªëng.'
                    };
                case 'No active app URL configured':
                    return {
                        title: 'Ch∆∞a c·∫•u h√¨nh App URL!',
                        text: 'Vui l√≤ng li√™n h·ªá admin ƒë·ªÉ c·∫•u h√¨nh ƒë∆∞·ªùng d·∫´n ·ª©ng d·ª•ng.'
                    };
                default:
                    return {
                        title: 'C√≥ l·ªói x·∫£y ra!',
                        text: 'Vui l√≤ng th·ª≠ l·∫°i ho·∫∑c s·ª≠ d·ª•ng c√°ch "D√πng Cookies".'
                    };
            }
        }

        function getPasteErrorMessage(error) {
            switch(error) {
                case 'Clipboard empty':
                    return {
                        title: 'Ch∆∞a c√≥ d·ªØ li·ªáu trong b·ªô nh·ªõ!',
                        text: 'B·∫°n c·∫ßn th·ª±c hi·ªán B∆∞·ªõc 3 v√† B∆∞·ªõc 4 tr∆∞·ªõc. Nh·∫•n v√†o icon EditThisCookie r·ªìi nh·∫•n n√∫t Export.'
                    };
                case 'Invalid JSON':
                    return {
                        title: 'D·ªØ li·ªáu kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng!',
                        text: 'D·ªØ li·ªáu b·∫°n sao ch√©p kh√¥ng ph·∫£i l√† cookies. Vui l√≤ng nh·∫•n ƒë√∫ng n√∫t Export (m≈©i t√™n l√™n) trong EditThisCookie.'
                    };
                case 'Not an array':
                    return {
                        title: 'ƒê·ªãnh d·∫°ng cookies kh√¥ng h·ª£p l·ªá!',
                        text: 'Vui l√≤ng th·ª≠ l·∫°i t·ª´ B∆∞·ªõc 2: M·ªü trang aistudio.google.com, sau ƒë√≥ th·ª±c hi·ªán l·∫°i c√°c b∆∞·ªõc.'
                    };
                case 'Empty array':
                    return {
                        title: 'Kh√¥ng c√≥ cookies n√†o!',
                        text: 'Danh s√°ch cookies tr·ªëng. Vui l√≤ng ƒë·∫£m b·∫£o b·∫°n ƒë√£ ƒëƒÉng nh·∫≠p t√†i kho·∫£n Google tr√™n trang aistudio.google.com.'
                    };
                case 'Invalid cookie format':
                    return {
                        title: 'Cookies kh√¥ng ƒë√∫ng ƒë·ªãnh d·∫°ng!',
                        text: 'M·ªói cookie c·∫ßn c√≥ domain, name v√† value. Vui l√≤ng s·ª≠ d·ª•ng extension EditThisCookie v√† nh·∫•n n√∫t Export ƒë·ªÉ sao ch√©p ƒë√∫ng c√°ch.'
                    };
                case 'Wrong domain':
                    return {
                        title: 'Cookies kh√¥ng ph·∫£i t·ª´ Google!',
                        text: 'B·∫°n c·∫ßn sao ch√©p cookies t·ª´ trang aistudio.google.com. Vui l√≤ng m·ªü trang ƒë√≥, ƒëƒÉng nh·∫≠p, r·ªìi th·ª±c hi·ªán l·∫°i B∆∞·ªõc 3 v√† 4.'
                    };
                default:
                    return {
                        title: 'C√≥ l·ªói x·∫£y ra!',
                        text: 'Vui l√≤ng th·ª≠ l·∫°i. N·∫øu v·∫´n g·∫∑p l·ªói, h√£y kh·ªüi ƒë·ªông l·∫°i ·ª©ng d·ª•ng.'
                    };
            }
        }
    </script>
</body>
</html>
